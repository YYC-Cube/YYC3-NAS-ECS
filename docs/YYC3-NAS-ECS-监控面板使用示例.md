# YYCÂ³ NAS-ECS ç›‘æ§é¢æ¿ä½¿ç”¨ç¤ºä¾‹

**åˆ›å»ºæ—¥æœŸ**: 2026-01-25  
**ä½œè€…**: YYCÂ³ Team  
**ç‰ˆæœ¬**: 1.0.0

---

## ğŸ“‹ ç›®å½•

1. [å¿«é€Ÿå…¥é—¨](#å¿«é€Ÿå…¥é—¨)
2. [åŸºç¡€ä½¿ç”¨ç¤ºä¾‹](#åŸºç¡€ä½¿ç”¨ç¤ºä¾‹)
3. [é«˜çº§ä½¿ç”¨ç¤ºä¾‹](#é«˜çº§ä½¿ç”¨ç¤ºä¾‹)
4. [APIä½¿ç”¨ç¤ºä¾‹](#apiä½¿ç”¨ç¤ºä¾‹)
5. [è‡ªå®šä¹‰ç›‘æ§ç¤ºä¾‹](#è‡ªå®šä¹‰ç›‘æ§ç¤ºä¾‹)
6. [å‘Šè­¦é…ç½®ç¤ºä¾‹](#å‘Šè­¦é…ç½®ç¤ºä¾‹)
7. [æ•…éšœæ’æŸ¥ç¤ºä¾‹](#æ•…éšœæ’æŸ¥ç¤ºä¾‹)
8. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## å¿«é€Ÿå…¥é—¨

### 1. è®¿é—®ç›‘æ§é¢æ¿

**æ­¥éª¤**:
1. ç™»å½•YYCÂ³ NAS-ECSç³»ç»Ÿ
2. ç‚¹å‡»å·¦ä¾§å¯¼èˆªæ çš„"ç›‘æ§é¢æ¿"
3. è¿›å…¥å®æ—¶ç›‘æ§ç•Œé¢

**ç•Œé¢è¯´æ˜**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç›‘æ§é¢æ¿                        [åˆ·æ–°] [è®¾ç½®]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CPU: 45%  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   â”‚
â”‚  å†…å­˜: 62%  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘   â”‚
â”‚  ç£ç›˜: 78%  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘   â”‚
â”‚  ç½‘ç»œ: â†‘ 1.2MB/s  â†“ 0.8MB/s              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [CPUå†å²] [å†…å­˜å†å²] [ç£ç›˜å†å²] [ç½‘ç»œå†å²]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€

**ç³»ç»ŸçŠ¶æ€æŒ‡æ ‡**:
- **CPUä½¿ç”¨ç‡**: å½“å‰CPUä½¿ç”¨ç™¾åˆ†æ¯”
- **å†…å­˜ä½¿ç”¨ç‡**: å½“å‰å†…å­˜ä½¿ç”¨ç™¾åˆ†æ¯”
- **ç£ç›˜ä½¿ç”¨ç‡**: å½“å‰ç£ç›˜ä½¿ç”¨ç™¾åˆ†æ¯”
- **ç½‘ç»œæµé‡**: ä¸Šä¼ å’Œä¸‹è½½é€Ÿåº¦
- **ç³»ç»Ÿè´Ÿè½½**: ç³»ç»Ÿå¹³å‡è´Ÿè½½
- **è¿è¡Œæ—¶é—´**: ç³»ç»Ÿè¿ç»­è¿è¡Œæ—¶é—´

**çŠ¶æ€é¢œè‰²è¯´æ˜**:
- ğŸŸ¢ ç»¿è‰²: æ­£å¸¸ï¼ˆ< 70%ï¼‰
- ğŸŸ¡ é»„è‰²: è­¦å‘Šï¼ˆ70-90%ï¼‰
- ğŸ”´ çº¢è‰²: ä¸¥é‡ï¼ˆ> 90%ï¼‰

### 3. è®¾ç½®å‘Šè­¦é˜ˆå€¼

**æ­¥éª¤**:
1. ç‚¹å‡»å³ä¸Šè§’"è®¾ç½®"æŒ‰é’®
2. è¿›å…¥å‘Šè­¦é…ç½®é¡µé¢
3. è®¾ç½®å„é¡¹å‘Šè­¦é˜ˆå€¼:
   - CPUå‘Šè­¦é˜ˆå€¼: é»˜è®¤80%
   - å†…å­˜å‘Šè­¦é˜ˆå€¼: é»˜è®¤85%
   - ç£ç›˜å‘Šè­¦é˜ˆå€¼: é»˜è®¤90%
4. ç‚¹å‡»"ä¿å­˜"æŒ‰é’®

**é…ç½®ç¤ºä¾‹**:
```typescript
// å‘Šè­¦é˜ˆå€¼é…ç½®
const alertThresholds = {
  cpu: 80,      // CPUä½¿ç”¨ç‡è¶…è¿‡80%æ—¶å‘Šè­¦
  memory: 85,   // å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡85%æ—¶å‘Šè­¦
  disk: 90,     // ç£ç›˜ä½¿ç”¨ç‡è¶…è¿‡90%æ—¶å‘Šè­¦
  network: 100,  // ç½‘ç»œæµé‡è¶…è¿‡100MB/sæ—¶å‘Šè­¦
  load: 5,      // ç³»ç»Ÿè´Ÿè½½è¶…è¿‡5æ—¶å‘Šè­¦
};
```

### 4. æŸ¥çœ‹å†å²æ•°æ®

**æ­¥éª¤**:
1. ç‚¹å‡»"å†å²"æŒ‰é’®
2. é€‰æ‹©æ—¶é—´èŒƒå›´:
   - 1å°æ—¶
   - 24å°æ—¶
   - 7å¤©
   - 30å¤©
3. é€‰æ‹©æ•°æ®ç±»å‹:
   - CPU
   - å†…å­˜
   - ç£ç›˜
   - ç½‘ç»œ
4. æŸ¥çœ‹å†å²è¶‹åŠ¿å›¾

**å¯¼å‡ºæ•°æ®**:
```typescript
// å¯¼å‡ºå†å²æ•°æ®ä¸ºCSV
const exportData = async (timeRange: string, dataType: string) => {
  const response = await fetch(`/api/v2/monitor/export`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      timeRange,
      dataType,
      format: 'csv',
    }),
  });

  const blob = await response.blob();
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `monitor_${dataType}_${timeRange}.csv`;
  a.click();
};
```

---

## åŸºç¡€ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: è·å–å®æ—¶ç³»ç»ŸçŠ¶æ€

```typescript
// è·å–å®æ—¶ç³»ç»ŸçŠ¶æ€
const getSystemStats = async () => {
  try {
    const response = await fetch('/api/v2/system/stats');
    const data = await response.json();

    if (data.success) {
      const stats = data.data;
      console.log('ç³»ç»ŸçŠ¶æ€:', stats);
      
      // æ˜¾ç¤ºCPUä½¿ç”¨ç‡
      console.log(`CPUä½¿ç”¨ç‡: ${stats.cpu.usage}%`);
      
      // æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ
      console.log(`å†…å­˜ä½¿ç”¨: ${stats.memory.used}MB / ${stats.memory.total}MB`);
      
      // æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µ
      console.log(`ç£ç›˜ä½¿ç”¨: ${stats.disk.used}GB / ${stats.disk.total}GB`);
      
      // æ˜¾ç¤ºç½‘ç»œæµé‡
      console.log(`ç½‘ç»œæµé‡: â†‘${stats.network.in}KB/s â†“${stats.network.out}KB/s`);
      
      return stats;
    }
  } catch (error) {
    console.error('è·å–ç³»ç»ŸçŠ¶æ€å¤±è´¥:', error);
  }
};

// ä½¿ç”¨ç¤ºä¾‹
getSystemStats();
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "cpu": {
      "usage": 45.5,
      "cores": 8,
      "load": [1.2, 1.5, 1.8]
    },
    "memory": {
      "usage": 62.3,
      "total": 16384,
      "used": 10240,
      "free": 6144
    },
    "disk": {
      "usage": 78.5,
      "total": 1024,
      "used": 804,
      "free": 220
    },
    "network": {
      "in": 1228.8,
      "out": 819.2
    },
    "uptime": 86400
  }
}
```

### ç¤ºä¾‹2: è®¾ç½®å‘Šè­¦é˜ˆå€¼

```typescript
// è®¾ç½®å‘Šè­¦é˜ˆå€¼
const setAlertThresholds = async (thresholds: AlertThresholds) => {
  try {
    const response = await fetch('/api/v2/system/alert', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${token}`,
      },
      body: JSON.stringify(thresholds),
    });

    const data = await response.json();

    if (data.success) {
      console.log('å‘Šè­¦é˜ˆå€¼è®¾ç½®æˆåŠŸ:', data.data);
      return data.data;
    }
  } catch (error) {
    console.error('è®¾ç½®å‘Šè­¦é˜ˆå€¼å¤±è´¥:', error);
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const thresholds = {
  cpu: 80,
  memory: 85,
  disk: 90,
  network: 100,
  load: 5,
};

setAlertThresholds(thresholds);
```

**è¯·æ±‚ç¤ºä¾‹**:
```json
{
  "cpu": 80,
  "memory": 85,
  "disk": 90,
  "network": 100,
  "load": 5
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "cpu": 80,
    "memory": 85,
    "disk": 90,
    "network": 100,
    "load": 5
  }
}
```

### ç¤ºä¾‹3: è·å–å†å²ç›‘æ§æ•°æ®

```typescript
// è·å–å†å²ç›‘æ§æ•°æ®
const getHistoryData = async (params: HistoryParams) => {
  try {
    const queryParams = new URLSearchParams({
      timeRange: params.timeRange,
      dataType: params.dataType,
      interval: params.interval || '5m',
    });

    const response = await fetch(`/api/v2/monitor/history?${queryParams}`);
    const data = await response.json();

    if (data.success) {
      console.log('å†å²æ•°æ®:', data.data);
      return data.data;
    }
  } catch (error) {
    console.error('è·å–å†å²æ•°æ®å¤±è´¥:', error);
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const historyParams = {
  timeRange: '24h',    // æ—¶é—´èŒƒå›´: 1h, 6h, 24h, 7d, 30d
  dataType: 'cpu',       // æ•°æ®ç±»å‹: cpu, memory, disk, network
  interval: '5m',       // æ•°æ®é—´éš”: 1m, 5m, 15m, 1h
};

getHistoryData(historyParams);
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "dataType": "cpu",
    "timeRange": "24h",
    "interval": "5m",
    "dataPoints": [
      {
        "timestamp": "2026-01-25T00:00:00Z",
        "value": 42.5
      },
      {
        "timestamp": "2026-01-25T00:05:00Z",
        "value": 45.2
      }
    ]
  }
}
```

---

## é«˜çº§ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: è‡ªå®šä¹‰ç›‘æ§é¡¹

```typescript
// æ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹
const addCustomMonitor = async (monitor: CustomMonitor) => {
  try {
    const response = await fetch('/api/v2/monitor/custom', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${token}`,
      },
      body: JSON.stringify(monitor),
    });

    const data = await response.json();

    if (data.success) {
      console.log('è‡ªå®šä¹‰ç›‘æ§é¡¹æ·»åŠ æˆåŠŸ:', data.data);
      return data.data;
    }
  } catch (error) {
    console.error('æ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹å¤±è´¥:', error);
  }
};

// ä½¿ç”¨ç¤ºä¾‹ - ç›‘æ§ç‰¹å®šè¿›ç¨‹çš„CPUä½¿ç”¨ç‡
const customMonitor = {
  name: 'Node.jsè¿›ç¨‹ç›‘æ§',
  type: 'process',
  query: 'SELECT cpu_usage FROM processes WHERE name = "node"',
  interval: 60,           // 60ç§’æ£€æŸ¥ä¸€æ¬¡
  threshold: 90,          // è¶…è¿‡90%æ—¶å‘Šè­¦
  alert: true,            // å¯ç”¨å‘Šè­¦
  description: 'ç›‘æ§Node.jsè¿›ç¨‹çš„CPUä½¿ç”¨ç‡',
};

addCustomMonitor(customMonitor);
```

**è¯·æ±‚ç¤ºä¾‹**:
```json
{
  "name": "Node.jsè¿›ç¨‹ç›‘æ§",
  "type": "process",
  "query": "SELECT cpu_usage FROM processes WHERE name = \"node\"",
  "interval": 60,
  "threshold": 90,
  "alert": true,
  "description": "ç›‘æ§Node.jsè¿›ç¨‹çš„CPUä½¿ç”¨ç‡"
}
```

### ç¤ºä¾‹2: é…ç½®å‘Šè­¦é€šçŸ¥

```typescript
// é…ç½®å‘Šè­¦é€šçŸ¥
const configureAlertNotification = async (config: AlertConfig) => {
  try {
    const response = await fetch('/api/v2/monitor/alert/notification', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${token}`,
      },
      body: JSON.stringify(config),
    });

    const data = await response.json();

    if (data.success) {
      console.log('å‘Šè­¦é€šçŸ¥é…ç½®æˆåŠŸ:', data.data);
      return data.data;
    }
  } catch (error) {
    console.error('é…ç½®å‘Šè­¦é€šçŸ¥å¤±è´¥:', error);
  }
};

// ä½¿ç”¨ç¤ºä¾‹ - é…ç½®é‚®ä»¶å’ŒWebhooké€šçŸ¥
const alertConfig = {
  email: {
    enabled: true,
    recipients: ['admin@example.com', 'ops@example.com'],
    subject: 'YYC3 NAS-ECS å‘Šè­¦é€šçŸ¥',
  },
  webhook: {
    enabled: true,
    url: 'https://hooks.example.com/alerts',
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
  },
  sms: {
    enabled: false,
    recipients: [],
  },
  telegram: {
    enabled: false,
    botToken: '',
    chatId: '',
  },
};

configureAlertNotification(alertConfig);
```

### ç¤ºä¾‹3: æ‰¹é‡è·å–ç›‘æ§æ•°æ®

```typescript
// æ‰¹é‡è·å–å¤šä¸ªç›‘æ§æŒ‡æ ‡
const getBatchMetrics = async (metrics: string[]) => {
  try {
    const response = await fetch('/api/v2/monitor/batch', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${token}`,
      },
      body: JSON.stringify({ metrics }),
    });

    const data = await response.json();

    if (data.success) {
      console.log('æ‰¹é‡ç›‘æ§æ•°æ®:', data.data);
      return data.data;
    }
  } catch (error) {
    console.error('è·å–æ‰¹é‡ç›‘æ§æ•°æ®å¤±è´¥:', error);
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const metrics = [
  'cpu.usage',
  'memory.usage',
  'disk.usage',
  'network.in',
  'network.out',
  'system.load',
];

getBatchMetrics(metrics);
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "cpu.usage": 45.5,
    "memory.usage": 62.3,
    "disk.usage": 78.5,
    "network.in": 1228.8,
    "network.out": 819.2,
    "system.load": [1.2, 1.5, 1.8]
  }
}
```

---

## APIä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: JavaScript/TypeScript

```typescript
// åˆ›å»ºç›‘æ§APIå®¢æˆ·ç«¯
class MonitoringAPI {
  private baseUrl: string;
  private token: string;

  constructor(baseUrl: string, token: string) {
    this.baseUrl = baseUrl;
    this.token = token;
  }

  private async request<T>(
    endpoint: string,
    options: RequestInit = {}
  ): Promise<T> {
    const url = `${this.baseUrl}${endpoint}`;
    const response = await fetch(url, {
      ...options,
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${this.token}`,
        ...options.headers,
      },
    });

    const data = await response.json();
    
    if (!data.success) {
      throw new Error(data.error?.message || 'è¯·æ±‚å¤±è´¥');
    }

    return data.data;
  }

  // è·å–ç³»ç»ŸçŠ¶æ€
  async getSystemStats(): Promise<SystemStats> {
    return this.request<SystemStats>('/api/v2/system/stats');
  }

  // è®¾ç½®å‘Šè­¦é˜ˆå€¼
  async setAlertThresholds(thresholds: AlertThresholds): Promise<AlertThresholds> {
    return this.request<AlertThresholds>('/api/v2/system/alert', {
      method: 'POST',
      body: JSON.stringify(thresholds),
    });
  }

  // è·å–å†å²æ•°æ®
  async getHistoryData(params: HistoryParams): Promise<HistoryData> {
    const queryParams = new URLSearchParams(params as any);
    return this.request<HistoryData>(`/api/v2/monitor/history?${queryParams}`);
  }

  // æ·»åŠ è‡ªå®šä¹‰ç›‘æ§
  async addCustomMonitor(monitor: CustomMonitor): Promise<CustomMonitor> {
    return this.request<CustomMonitor>('/api/v2/monitor/custom', {
      method: 'POST',
      body: JSON.stringify(monitor),
    });
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const api = new MonitoringAPI('http://localhost:6000', 'your-token-here');

// è·å–ç³»ç»ŸçŠ¶æ€
const stats = await api.getSystemStats();
console.log('ç³»ç»ŸçŠ¶æ€:', stats);

// è®¾ç½®å‘Šè­¦é˜ˆå€¼
await api.setAlertThresholds({
  cpu: 80,
  memory: 85,
  disk: 90,
});

// è·å–å†å²æ•°æ®
const history = await api.getHistoryData({
  timeRange: '24h',
  dataType: 'cpu',
});
console.log('å†å²æ•°æ®:', history);
```

### ç¤ºä¾‹2: Python

```python
import requests
from typing import Dict, Any, List

class MonitoringAPI:
    def __init__(self, base_url: str, token: str):
        self.base_url = base_url
        self.token = token
        self.headers = {
            'Content-Type': 'application/json',
            'Authorization': f'Bearer {token}'
        }

    def _request(self, endpoint: str, method: str = 'GET', data: Dict = None) -> Any:
        url = f'{self.base_url}{endpoint}'
        response = requests.request(
            method,
            url,
            headers=self.headers,
            json=data
        )
        
        result = response.json()
        
        if not result.get('success'):
            raise Exception(result.get('error', {}).get('message', 'è¯·æ±‚å¤±è´¥'))
        
        return result.get('data')

    def get_system_stats(self) -> Dict:
        """è·å–ç³»ç»ŸçŠ¶æ€"""
        return self._request('/api/v2/system/stats')

    def set_alert_thresholds(self, thresholds: Dict) -> Dict:
        """è®¾ç½®å‘Šè­¦é˜ˆå€¼"""
        return self._request(
            '/api/v2/system/alert',
            method='POST',
            data=thresholds
        )

    def get_history_data(self, time_range: str, data_type: str, interval: str = '5m') -> Dict:
        """è·å–å†å²æ•°æ®"""
        params = {
            'timeRange': time_range,
            'dataType': data_type,
            'interval': interval
        }
        return self._request(f'/api/v2/monitor/history?{params}')

# ä½¿ç”¨ç¤ºä¾‹
api = MonitoringAPI('http://localhost:6000', 'your-token-here')

# è·å–ç³»ç»ŸçŠ¶æ€
stats = api.get_system_stats()
print(f'ç³»ç»ŸçŠ¶æ€: {stats}')

# è®¾ç½®å‘Šè­¦é˜ˆå€¼
api.set_alert_thresholds({
    'cpu': 80,
    'memory': 85,
    'disk': 90
})

# è·å–å†å²æ•°æ®
history = api.get_history_data('24h', 'cpu')
print(f'å†å²æ•°æ®: {history}')
```

### ç¤ºä¾‹3: cURL

```bash
# è·å–ç³»ç»ŸçŠ¶æ€
curl -X GET \
  -H "Authorization: Bearer your-token-here" \
  http://localhost:6000/api/v2/system/stats

# è®¾ç½®å‘Šè­¦é˜ˆå€¼
curl -X POST \
  -H "Authorization: Bearer your-token-here" \
  -H "Content-Type: application/json" \
  -d '{"cpu":80,"memory":85,"disk":90}' \
  http://localhost:6000/api/v2/system/alert

# è·å–å†å²æ•°æ®
curl -X GET \
  -H "Authorization: Bearer your-token-here" \
  "http://localhost:6000/api/v2/monitor/history?timeRange=24h&dataType=cpu&interval=5m"

# æ·»åŠ è‡ªå®šä¹‰ç›‘æ§
curl -X POST \
  -H "Authorization: Bearer your-token-here" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "è‡ªå®šä¹‰ç›‘æ§",
    "type": "custom",
    "query": "SELECT * FROM metrics",
    "interval": 60,
    "threshold": 90,
    "alert": true
  }' \
  http://localhost:6000/api/v2/monitor/custom
```

---

## è‡ªå®šä¹‰ç›‘æ§ç¤ºä¾‹

### ç¤ºä¾‹1: ç›‘æ§æ•°æ®åº“è¿æ¥æ•°

```typescript
// æ·»åŠ æ•°æ®åº“è¿æ¥æ•°ç›‘æ§
const dbConnectionMonitor = {
  name: 'æ•°æ®åº“è¿æ¥æ•°ç›‘æ§',
  type: 'database',
  query: 'SELECT count(*) FROM pg_stat_activity WHERE datname = '\''yyc3_nas_db'\''',
  interval: 30,           // 30ç§’æ£€æŸ¥ä¸€æ¬¡
  threshold: 100,         // è¶…è¿‡100ä¸ªè¿æ¥æ—¶å‘Šè­¦
  alert: true,
  description: 'ç›‘æ§PostgreSQLæ•°æ®åº“çš„è¿æ¥æ•°',
};

addCustomMonitor(dbConnectionMonitor);
```

### ç¤ºä¾‹2: ç›‘æ§APIå“åº”æ—¶é—´

```typescript
// æ·»åŠ APIå“åº”æ—¶é—´ç›‘æ§
const apiResponseTimeMonitor = {
  name: 'APIå“åº”æ—¶é—´ç›‘æ§',
  type: 'api',
  query: 'SELECT avg(response_time) FROM api_logs WHERE timestamp > NOW() - INTERVAL '\''5 minutes'\''',
  interval: 60,           // 60ç§’æ£€æŸ¥ä¸€æ¬¡
  threshold: 500,         // è¶…è¿‡500msæ—¶å‘Šè­¦
  alert: true,
  description: 'ç›‘æ§APIå¹³å‡å“åº”æ—¶é—´',
};

addCustomMonitor(apiResponseTimeMonitor);
```

### ç¤ºä¾‹3: ç›‘æ§ç£ç›˜I/O

```typescript
// æ·»åŠ ç£ç›˜I/Oç›‘æ§
const diskIOMonitor = {
  name: 'ç£ç›˜I/Oç›‘æ§',
  type: 'disk',
  query: 'SELECT disk_read_bytes, disk_write_bytes FROM system_metrics',
  interval: 60,           // 60ç§’æ£€æŸ¥ä¸€æ¬¡
  threshold: 100 * 1024 * 1024,  // è¶…è¿‡100MB/sæ—¶å‘Šè­¦
  alert: true,
  description: 'ç›‘æ§ç£ç›˜è¯»å†™é€Ÿåº¦',
};

addCustomMonitor(diskIOMonitor);
```

---

## å‘Šè­¦é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹1: é…ç½®å¤šçº§å‘Šè­¦

```typescript
// é…ç½®å¤šçº§å‘Šè­¦è§„åˆ™
const multiLevelAlerts = {
  name: 'CPUå¤šçº§å‘Šè­¦',
  metric: 'cpu.usage',
  rules: [
    {
      level: 'warning',
      threshold: 70,
      duration: 300,      // æŒç»­5åˆ†é’Ÿ
      actions: ['log', 'email'],
    },
    {
      level: 'critical',
      threshold: 90,
      duration: 60,       // æŒç»­1åˆ†é’Ÿ
      actions: ['log', 'email', 'webhook', 'sms'],
    },
  ],
};

const configureMultiLevelAlerts = async (config: any) => {
  const response = await fetch('/api/v2/monitor/alert/multi-level', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`,
    },
    body: JSON.stringify(config),
  });

  const data = await response.json();
  console.log('å¤šçº§å‘Šè­¦é…ç½®æˆåŠŸ:', data.data);
};

configureMultiLevelAlerts(multiLevelAlerts);
```

### ç¤ºä¾‹2: é…ç½®æ™ºèƒ½å‘Šè­¦

```typescript
// é…ç½®æ™ºèƒ½å‘Šè­¦ï¼ˆåŸºäºæœºå™¨å­¦ä¹ ï¼‰
const smartAlertConfig = {
  name: 'æ™ºèƒ½CPUå‘Šè­¦',
  metric: 'cpu.usage',
  algorithm: 'anomaly_detection',  // å¼‚å¸¸æ£€æµ‹ç®—æ³•
  sensitivity: 'medium',           // æ•æ„Ÿåº¦
  baselinePeriod: '7d',            // åŸºçº¿å‘¨æœŸ
  alertThreshold: 2.0,            // å¼‚å¸¸å€æ•°
  actions: ['log', 'email', 'webhook'],
};

const configureSmartAlert = async (config: any) => {
  const response = await fetch('/api/v2/monitor/alert/smart', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`,
    },
    body: JSON.stringify(config),
  });

  const data = await response.json();
  console.log('æ™ºèƒ½å‘Šè­¦é…ç½®æˆåŠŸ:', data.data);
};

configureSmartAlert(smartAlertConfig);
```

---

## æ•…éšœæ’æŸ¥ç¤ºä¾‹

### ç¤ºä¾‹1: æ£€æŸ¥ç›‘æ§æœåŠ¡çŠ¶æ€

```typescript
// æ£€æŸ¥ç›‘æ§æœåŠ¡çŠ¶æ€
const checkMonitorService = async () => {
  try {
    const response = await fetch('/api/v2/monitor/health');
    const data = await response.json();

    if (data.success) {
      const health = data.data;
      console.log('ç›‘æ§æœåŠ¡çŠ¶æ€:', health);
      
      // æ£€æŸ¥å„é¡¹æœåŠ¡çŠ¶æ€
      if (health.database === 'healthy') {
        console.log('âœ… æ•°æ®åº“æœåŠ¡æ­£å¸¸');
      } else {
        console.log('âŒ æ•°æ®åº“æœåŠ¡å¼‚å¸¸');
      }
      
      if (health.redis === 'healthy') {
        console.log('âœ… RedisæœåŠ¡æ­£å¸¸');
      } else {
        console.log('âŒ RedisæœåŠ¡å¼‚å¸¸');
      }
      
      if (health.collector === 'healthy') {
        console.log('âœ… æ•°æ®é‡‡é›†æœåŠ¡æ­£å¸¸');
      } else {
        console.log('âŒ æ•°æ®é‡‡é›†æœåŠ¡å¼‚å¸¸');
      }
      
      return health;
    }
  } catch (error) {
    console.error('æ£€æŸ¥ç›‘æ§æœåŠ¡çŠ¶æ€å¤±è´¥:', error);
  }
};

checkMonitorService();
```

### ç¤ºä¾‹2: æŸ¥çœ‹ç›‘æ§æ—¥å¿—

```typescript
// æŸ¥çœ‹ç›‘æ§æ—¥å¿—
const getMonitorLogs = async (params: LogParams) => {
  try {
    const queryParams = new URLSearchParams({
      level: params.level || 'info',
      limit: params.limit?.toString() || '100',
      offset: params.offset?.toString() || '0',
    });

    const response = await fetch(`/api/v2/monitor/logs?${queryParams}`);
    const data = await response.json();

    if (data.success) {
      console.log('ç›‘æ§æ—¥å¿—:', data.data);
      return data.data;
    }
  } catch (error) {
    console.error('è·å–ç›‘æ§æ—¥å¿—å¤±è´¥:', error);
  }
};

// ä½¿ç”¨ç¤ºä¾‹ - æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯æ—¥å¿—
getMonitorLogs({
  level: 'error',
  limit: 50,
});
```

### ç¤ºä¾‹3: é‡å¯ç›‘æ§æœåŠ¡

```typescript
// é‡å¯ç›‘æ§æœåŠ¡
const restartMonitorService = async () => {
  try {
    const response = await fetch('/api/v2/monitor/restart', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${token}`,
      },
    });

    const data = await response.json();

    if (data.success) {
      console.log('ç›‘æ§æœåŠ¡é‡å¯æˆåŠŸ:', data.data);
      return data.data;
    }
  } catch (error) {
    console.error('é‡å¯ç›‘æ§æœåŠ¡å¤±è´¥:', error);
  }
};

restartMonitorService();
```

---

## æœ€ä½³å®è·µ

### 1. åˆç†è®¾ç½®å‘Šè­¦é˜ˆå€¼

**å»ºè®®**:
- CPUå‘Šè­¦é˜ˆå€¼: 80-85%
- å†…å­˜å‘Šè­¦é˜ˆå€¼: 85-90%
- ç£ç›˜å‘Šè­¦é˜ˆå€¼: 90-95%
- ç½‘ç»œå‘Šè­¦é˜ˆå€¼: æ ¹æ®å¸¦å®½è®¾ç½®
- ç³»ç»Ÿè´Ÿè½½: æ ¹æ®CPUæ ¸å¿ƒæ•°è®¾ç½®ï¼ˆå¦‚8æ ¸å¿ƒè®¾ç½®ä¸º5ï¼‰

**ç¤ºä¾‹**:
```typescript
const recommendedThresholds = {
  cpu: 80,
  memory: 85,
  disk: 90,
  network: 100,  // 100MB/s
  load: 5,       // 8æ ¸å¿ƒCPU
};
```

### 2. ä½¿ç”¨å¤šçº§å‘Šè­¦

**ä¼˜åŠ¿**:
- é¿å…å‘Šè­¦ç–²åŠ³
- åŒºåˆ†å‘Šè­¦ä¸¥é‡ç¨‹åº¦
- æé«˜å‘Šè­¦å‡†ç¡®æ€§

**ç¤ºä¾‹**:
```typescript
const multiLevelAlerts = {
  warning: { threshold: 70, actions: ['log'] },
  critical: { threshold: 90, actions: ['log', 'email', 'webhook'] },
};
```

### 3. å®šæœŸå®¡æŸ¥ç›‘æ§é…ç½®

**å»ºè®®**:
- æ¯æœˆå®¡æŸ¥ä¸€æ¬¡å‘Šè­¦é˜ˆå€¼
- æ¯å­£åº¦å®¡æŸ¥ä¸€æ¬¡ç›‘æ§é¡¹
- æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´é…ç½®

### 4. ä½¿ç”¨æ™ºèƒ½å‘Šè­¦

**ä¼˜åŠ¿**:
- åŸºäºå†å²æ•°æ®å­¦ä¹ 
- è‡ªåŠ¨è¯†åˆ«å¼‚å¸¸
- å‡å°‘è¯¯æŠ¥

**ç¤ºä¾‹**:
```typescript
const smartAlertConfig = {
  algorithm: 'anomaly_detection',
  sensitivity: 'medium',
  baselinePeriod: '7d',
};
```

### 5. å»ºç«‹å‘Šè­¦å“åº”æµç¨‹

**å»ºè®®**:
1. æ¥æ”¶å‘Šè­¦é€šçŸ¥
2. è¯„ä¼°å‘Šè­¦ä¸¥é‡ç¨‹åº¦
3. æŸ¥çœ‹ç›‘æ§æ•°æ®å’Œæ—¥å¿—
4. é‡‡å–ç›¸åº”æªæ–½
5. è®°å½•å¤„ç†è¿‡ç¨‹
6. å¤ç›˜å’Œä¼˜åŒ–

---

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•æ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹ï¼Ÿ

**A**: ä½¿ç”¨`/api/v2/monitor/custom`æ¥å£æ·»åŠ è‡ªå®šä¹‰ç›‘æ§é¡¹ï¼Œéœ€è¦æä¾›ç›‘æ§åç§°ã€æŸ¥è¯¢è¯­å¥ã€æ£€æŸ¥é—´éš”ã€å‘Šè­¦é˜ˆå€¼ç­‰ä¿¡æ¯ã€‚

### Q2: å¦‚ä½•é…ç½®å¤šä¸ªå‘Šè­¦é€šçŸ¥æ¸ é“ï¼Ÿ

**A**: ä½¿ç”¨`/api/v2/monitor/alert/notification`æ¥å£é…ç½®å¤šä¸ªé€šçŸ¥æ¸ é“ï¼ŒåŒ…æ‹¬é‚®ä»¶ã€Webhookã€çŸ­ä¿¡ã€Telegramç­‰ã€‚

### Q3: å¦‚ä½•å¯¼å‡ºç›‘æ§æ•°æ®ï¼Ÿ

**A**: ä½¿ç”¨`/api/v2/monitor/export`æ¥å£å¯¼å‡ºç›‘æ§æ•°æ®ï¼Œæ”¯æŒCSVã€JSONç­‰æ ¼å¼ã€‚

### Q4: å¦‚ä½•æŸ¥çœ‹å†å²ç›‘æ§æ•°æ®ï¼Ÿ

**A**: ä½¿ç”¨`/api/v2/monitor/history`æ¥å£æŸ¥çœ‹å†å²æ•°æ®ï¼Œå¯ä»¥æŒ‡å®šæ—¶é—´èŒƒå›´ã€æ•°æ®ç±»å‹ã€æ•°æ®é—´éš”ç­‰å‚æ•°ã€‚

### Q5: å¦‚ä½•è®¾ç½®å¤šçº§å‘Šè­¦ï¼Ÿ

**A**: ä½¿ç”¨`/api/v2/monitor/alert/multi-level`æ¥å£é…ç½®å¤šçº§å‘Šè­¦ï¼Œå¯ä»¥è®¾ç½®ä¸åŒçº§åˆ«çš„é˜ˆå€¼å’Œå“åº”åŠ¨ä½œã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2026-01-25  
**ç»´æŠ¤å›¢é˜Ÿ**: YYCÂ³ Team

---

<div align="center">

> ã€Œ***YanYuCloudCube***ã€
> ã€Œ***<admin@0379.email>***ã€
> ã€Œ***Words Initiate Quadrants, Language Serves as Core for the Future***ã€
> ã€Œ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***ã€

</div>
