# ============================== 生产环境专属配置 ==============================
# 防误迁移警告：必须确认安全项后部署！
# 生产环境特征：强密码、固定生产IP、禁止开发网段、严格内存限制（Docker用户：yanyuit）

# 引入通用基础配置（容器内路径）
include /etc/redis/redis-base.conf

# 网络：生产环境建议绑定具体内网IP（此处为容器通用绑定）
bind 0.0.0.0
protected-mode yes

# 安全：极简基线——仅保留密码认证，取消命令重命名
requirepass redis_yyc3
# 保留 CONFIG 命令，方便运维调优

# 持久化：生产级配置（避免数据丢失，NAS生产存储）
save 900 1
save 300 10
stop-writes-on-bgsave-error yes
dbfilename dump-prod.rdb
appendfilename "appendonly-prod.aof"
dir /data
no-appendfsync-on-rewrite yes
auto-aof-rewrite-percentage 150

# 内存：生产分配32GB（云服务器按实际内存调整）
maxmemory 8gb
maxmemory-policy volatile-lru

# 其他生产级限制
maxclients 1000
replica-read-only yes
aof-load-truncated yes
